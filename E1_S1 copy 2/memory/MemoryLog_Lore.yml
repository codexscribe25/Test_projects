# MemoryLog_Lore.yml
# Persistent project-scale lore memory. Only append via approved ticket (05b).
# MemoryLog_Lore.yml header (dev instructions)
# ---
# purpose: "Persistent project-scale lore memory. This file is the canonical cross-session memory that LLMs can read for context. Entries are appended only via the approved approval ticket (05b)."
# readme: "Do not edit this file directly in production. Use 05b_E1_S1-lore-approve-refs.yml to append entries after human validation/ack."
# schema_quick_reference:
#   - memory_lore:
#       version: <integer>
#       generated_at: <ISO8601 timestamp>
#       project: <project id, e.g. E1_S1>
#       entries:  # list
#         - canonical_id: "canon:unique-id"
#           term: "Human-friendly name"
#           short_description: "1-2 sentence summary"
#           first_appearance:
#             file: "path/to/artifact"
#             line_hint: <int, optional>
#           confidence: 0.0-1.0
#           status: "draft|proposed|approved|deprecated"
#           created_by: "<username>"
#           created_ts: "<ISO8601 timestamp>"
#           provenance:  # list of provenance items
#             - note: "why/where"
#               ticket: "<ticket that created/approved>"
#               artifact: "<artifact path>"
#           references:
#             - artifact_path: "path/to/export"
#               anchor: "para-12"
#           tags: [ "tag1", "tag2" ]
#           notes: "Freeform notes (markdown block allowed)"
# usage_guidance:
#   - This file is the authoritative canonical memory for lore/codex items for the project.
#   - Appends must include approver metadata (created_by, created_ts) and provenance.
#   - Keep entries concise; use canonical_id for cross-referencing across tickets and exports.
# audit:
#   - For runtime events, consult logs/logmarks.ndjson (append-only event log).
#   - For deriving Theme files, run 00b_E1_S1-sync-theme-from-memory-refs.yml.
# example_entry: |
#   - canonical_id: "canon:example-001"
#     term: "House of Fenn"
#     short_description: "A maritime merchant house specializing in sealed crates and ledger secrets."
#     first_appearance:
#       file: "10_drafts/episode1_v1.md"
#       line_hint: 412
#     confidence: 0.90
#     status: "approved"
#     created_by: "alice"
#     created_ts: "2025-09-04T12:34:00Z"
#     provenance:
#       - note: "Created from E1_S1 lore audit and approved by lead"
#         ticket: "05_E1_S1-lore-audit-refs.yml"
#         artifact: "canon_packet_stub.md"
#     references:
#       - artifact_path: "40_exports/episode1_final.md"
#         anchor: "para-12"
#     tags: ["merchant-house","maritime"]
#     notes: "Keep entry concise; add external sources if available."
# MemoryLog_Lore.yml â€” preflight (write-safety rules)
preflight:
  description: "Canonical lore memory; only write via 05b approval ticket."
  require_files:
    - "Theme_Enforcement_State.yml"
  write_policy:
    single_writer_ticket: "05b_E1_S1-lore-approve-refs.yml"
    append_only: true
  fail_on_direct_edit: true

memory_lore:
  version: 1
  generated_at: "20250904T133056Z"
  project: "E1_S1"
  entries:
    - canonical_id: "canon:example-001"
      term: "House of Fenn"
      short_description: "A maritime merchant house specializing in sealed crates and ledger secrets."
      first_appearance:
        file: "10_drafts/episode1_v1.md"
        line_hint: 412
      confidence: 0.90
      status: "approved"           # draft | proposed | approved | deprecated
      created_by: "alice"
      created_ts: "20250904T133056Z"
      provenance:
        - note: "Created from E1_S1 lore audit and approved by lead"
          ticket: "05_E1_S1-lore-audit-refs.yml"
          artifact: "canon_packet_stub.md"
      references:
        - artifact_path: "40_exports/episode1_final.md"
          anchor: "para-12"
      tags: ["merchant-house", "maritime"]
      notes: |
        Keep entry concise; add external sources if available.
